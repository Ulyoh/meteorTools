{"version":3,"sources":["/tools/tool-env/cleanup.js"],"names":[],"mappings":";;;AAGA,IAAI,CAAC,GAAG,OAAO,CAAC,YAAY,CAAC,CAAC;;AAE9B,IAAI,YAAY,GAAG,OAAO,CAAC,2BAA2B,CAAC,CAAC;;AAExD,IAAI,OAAO,GAAG,OAAO,CAAC;AACtB,CAAC,CAAC,MAAM,CAAC,OAAO,EAAE;AAChB,eAAa,EAAE,EAAE;;;;AAIjB,QAAM,EAAE,UAAU,IAAI,EAAE;AACtB,QAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;GAC/B;CACF,CAAC,CAAC;;AAEH,IAAI,WAAW,GAAG,YAAY;AAC5B,cAAY,CAAC,eAAe,CAAC,YAAY;AACvC,QAAI,QAAQ,GAAG,OAAO,CAAC,aAAa,CAAC;AACrC,WAAO,CAAC,aAAa,GAAG,EAAE,CAAC;AAC3B,KAAC,CAAC,IAAI,CAAC,QAAQ,EAAE,UAAU,CAAC,EAAE;AAC5B,OAAC,EAAE,CAAC;KACL,CAAC,CAAC;GACJ,CAAC,CAAC;CACJ,CAAC;;AAEF,OAAO,CAAC,EAAE,CAAC,MAAM,EAAE,WAAW,CAAC,CAAC;AAChC,CAAC,CAAC,IAAI,CAAC,CAAC,QAAQ,EAAE,QAAQ,EAAE,SAAS,CAAC,EAAE,UAAU,GAAG,EAAE;AACrD,SAAO,CAAC,IAAI,CAAC,GAAG,EAAE,YAAY;AAC5B,eAAW,EAAE,CAAC;AACd,WAAO,CAAC,IAAI,CAAC,OAAO,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC;GAChC,CAAC,CAAC;CACJ,CAAC,CAAC","file":"tools/tool-env/cleanup.js.map","sourcesContent":["/// A simple interface to register functions to be called when the process\n/// exits.\n\nvar _ = require('underscore');\n\nvar fiberHelpers = require('../utils/fiber-helpers.js');\n\nvar cleanup = exports;\n_.extend(exports, {\n  _exitHandlers: [],\n\n  // register a function that will be called on SIGINT (e.g. Cmd-C on\n  // mac)\n  onExit: function (func) {\n    this._exitHandlers.push(func);\n  }\n});\n\nvar runHandlers = function () {\n  fiberHelpers.noYieldsAllowed(function () {\n    var handlers = cleanup._exitHandlers;\n    cleanup._exitHandlers = [];\n    _.each(handlers, function (f) {\n      f();\n    });\n  });\n};\n\nprocess.on('exit', runHandlers);\n_.each(['SIGINT', 'SIGHUP', 'SIGTERM'], function (sig) {\n  process.once(sig, function () {\n    runHandlers();\n    process.kill(process.pid, sig);\n  });\n});\n"]}